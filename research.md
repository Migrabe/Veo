# Research: Текущая структура Grav4

**Проект скопирован в директорию**: `C:\Users\TOT\Documents\GravVPE\`.  
В новую рабочую папку перенесены основные файлы:
1. `index.html` (основной генератор промптов)
2. `VideoPrompt.html` (генератор видео-промптов, ранее `VideoPrompt — Kling 3.0 · Veo 3.1 · Seedance 2.html`)

---

## 1. Страница генерации промптов и связанные компоненты
- **Файл**: `index.html`
- **Архитектура**: Vanilla JavaScript + HTML + CSS в одном файле (Single Page Application без использования фреймворков).
- **Стэйт (состояние)**: Хранится в глобальном объекте `let state = { ... }` (или аналогичных переменных) на стороне клиента, в нем находятся все выбранные опции стилей, сред, камер и освещения.
- **Интерфейс**: Разделы скрываются/показываются через добавление CSS-классов (например, `.collapsed`) и inline-стили `display: none/block`. Логика раскрытия реализована в IIFE внутри `<script>`.
- **Генерация промптов**: Логика формирования итогового текста реализована глобальными функциями, такими как `buildFlatPrompt()`, `buildStructuredPrompt()`, `buildMidjourneyPrompt()`, `buildJson()`.

## 2. Система роутинга
- **Текущее состояние**: Отсутствует. Весь интерфейс работает в рамках одного загруженного HTML-документа. Навигация между "страницами" (например, переход к VideoPrompt) не реализована на уровне SPA-роутера, это просто отдельные HTML-файлы.

## 3. API-клиенты и обращение к нейросетям
- **Функции отправки запросов**:
  - `callGroq(prompt, key)`: Отправляет POST-запрос через `fetch` к `https://api.groq.com/openai/v1/chat/completions` (используется модель `llama-3.3-70b-versatile`). Внутри функции хардкодится API-ключ.
  - `callGemini(prompt)`: Отправляет POST-запрос через `fetch` к `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent`.
- **Интеграция с n8n**: Обработчик на кнопке `#sendToN8nBtn` отправляет JSON-объект `payload` (с промптом и данными `buildJson()`) POST-запросом через `fetch` на указанный URL вебхука.
- **Аутентификация и платежи**: Специфический код для Google Auth и биллинга/платежных шлюзов в текущей базе отсутствует.
